<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Alcohol Prohibition - Gallery</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;600&display=swap');
*{margin:0;padding:0;box-sizing:border-box}
body{background:#0a0a0f;color:#e8e0d4;font-family:'Source Sans 3',sans-serif;overflow:hidden}
#decision{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(10,10,15,0.95);border:3px solid #c4a86b;padding:2em;max-width:600px;z-index:200;display:none;border-radius:8px}
#decision h2{color:#c4a86b;margin-bottom:1em;font-size:1.5rem;text-align:center}
#decision p{color:#e8e0d4;margin-bottom:1.5em;line-height:1.6}
.choice-btn{font:400 0.9rem 'Source Sans 3';color:#e8e0d4;background:#2a2a2a;border:2px solid #c4a86b;padding:1em 1.5em;cursor:pointer;margin:0.5em;display:block;width:100%;text-align:left;transition:all 0.3s}
.choice-btn:hover{background:#c4a86b;color:#0a0a0f}
#consequence{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(10,10,15,0.98);border:3px solid #c4a86b;padding:2.5em;max-width:700px;max-height:80vh;overflow-y:auto;z-index:300;display:none;border-radius:8px}
#consequence h2{color:#c4a86b;margin-bottom:1em;font-size:1.8rem;text-align:center}
#consequence h3{color:#a89878;margin-top:1.5em;margin-bottom:0.5em;font-size:1.2rem}
#consequence p{color:#e8e0d4;margin-bottom:1em;line-height:1.7}
#consequence ul{color:#e8e0d4;margin-left:1.5em;margin-bottom:1em;line-height:1.7}
.close-btn{font:600 1rem 'Source Sans 3';color:#0a0a0f;background:#c4a86b;border:none;padding:0.8em 2em;cursor:pointer;margin-top:1em;display:block;margin-left:auto;margin-right:auto}
.close-btn:hover{background:#d9be80}
</style>
</head>
<body onload="start()">
<div id="canvas"></div>
<div id="decision"></div>
<div id="consequence"></div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
var DATA=[
{y:"1884",t:"Criminalization Begins",txt:"Alcohol control actually started back in 1775 with British colonial instructions to limit the liquor trade with Indigenous people. It was already being used in the fur trade for negotiations. In 1884, an amendment to the Indian Act made the prohibition much stricter. It was then illegal for Indigenous peoples to purchase, consume, or even enter licensed establishments. The punishments for breaking these laws were alot: $50 - 300 dollar fines(back then this was alot) and 1 to 6 months in jail with or without hard labour. The government's goal was to enforce control and encourage farming on reserves. They believed that Indigenous people could not handle alcohol properly."},
{y:"1914",t:"World War I: Serve and Be Forgotten",txt:"When World War 1 broke out. Indigenous soldiers signed up to fight for Canada. While serving in the military, they were allowed to drink just like every other soldier. The government trusted them as soldiers, but not as civilians. When they returned home, prohibition under the Indian Act still applied to them. Many were still banned from the Royal Canadian Legion because alcohol was served there. The legion was the veteran meeting place, where they shared stories and found out about the benefits they were owed. Indigenous veterans had little to no peer support and no information about veteran benefits. They were completely cut off, with the exception of a agent due to the Indian Act."},
{y:"1939",t:"World War II: The Same Thing All Over Again",txt:"The same issue from WW1 repeated during WW2, Indigenous soldiers had legal access to alcohol during their service. They fought, were wounded, and died along with their non-Indigenous comrades. Then they came home, and the ban kicked in again.  Legion halls were off limits because alcohol was served there. Veterans became dependent on Indian Agents for benefit information. The newsletters and meetings that explained housing support, pensions, and other benefits all happened inside those halls that they could not enter. It harmed their social life and integration a lot. Indigenous veterans were left on their own, separated from the people they fought beside."},
{y:"1951",t:"The Law Gets Even Stricter",txt:"Between 1946 and 1948, a committee of the Senate and House of Commons reviewed the Indian Act. There was testimony from Indigenous and non-Indigenous people, especially soldiers who Indigenous people fought. It was seen as discriminatory and ineffective. There was confirmation that prohibition contributed to the black market and drinking addictions. When 1951 rolled around, the Indian Act got revised. Instead of repealing alcohol bans, they made them stricter. It became an offence for an Indigenous person to possess alcohol or be intoxicated anywhere, on or off reserve. There was expanded surveillance and policing of Indigenous areas. By 1970, there were 39 references in the Indian Act related to intoxication and liquor offences. This shows how much control the government wanted. Indigenous people had to resort to fast drinking to avoid arrest and going to black markets, which led to addictions and harmful drinking patterns. This brought forth the stereotype that Indigenous people have alcohol intolerance."},
{y:"1960",t:"Tommy Douglas Speaks Out",txt:"In 1960, Saskatchewan Premier Tommy Douglas criticized the federal government for treating Indigenous people as second-class citizens. He compared the situation to apartheid, which was the racial segregation happening in South Africa. He argued that Canada had to choose between keeping Indigenous people separated or treating them as equal citizens. He stated that an Indigenous person should have the same right as anyone else to enter a bar, along with the same responsibility to behave appropriately. He maintained that laws against drunkenness should apply equally to everyone, not racially. He argued that the problem was the law, not the people."},
{y:"1960s-80s",t:"The Generational Wound",txt:"Residential schools, forced family separations, and decades of prohibition combined to create deep and lasting trauma. Children were taken from their families at a young age and placed in harsh institutions. Many grew up without the support of their parents and communities. After leaving, some turned to alcohol to cope with their experiences. These patterns often continued across generations. Sociologist Richard Thatcher showed that similar cycles appear in many populations that experience colonial disruption, and recovery can take multiple generations."},
{y:"1985",t:"Repeal, But the Scars Remain",txt:"In 1985, the alcohol offenses was repealed. The Indian Act was amended through BILL C-31. It removed the federal prohibition that targeted Indigenous peoples. Specifically, it granted band councils, the governing body of a First Nation in Canada, bylaw authority to regulate alcohol sales and possession locally. This led to Indigenus people being able to have self-governance. The reform aligned with the new Canadian Charter of Rights and Freedoms. The Canadian Charter of Rights and Freedoms is a section of the Constitution that lists the basic rights and freedoms every person in Canada has and prevents the government from passing unfair laws that take them away. This ended the racially based alcohol prohibition. However, there were alot of long-term impacts. Prohibition created black market systems and unsafe drinking practices. It helped create harmful stereotypes about Indigenous alcohol use. Intergenerational trauma contributed to substance use as a coping mechanism."},
{y:"Kahoot Quiz",t:"Test Your Knowledge",txt:"Scan the QR code to take the interactive quiz!",qr:1}
];
var scene,cam,rend,yaw=0,pitch=0,lock=0,keys={},shown=[0,0,0,0,0,0,0],raycaster,mouse,artifacts=[],started=0,curDec=0;
var decisions={
0:{title:"1884 Criminalization Begins",desc:"You are a federal official in 1884. Reports claim alcohol is causing disorder in Indigenous communities. What policy do you implement?",choices:["Ban alcohol completely for Indigenous people","Regulate alcohol equally under the same laws as all Canadians","Invest in economic support and community partnership instead of prohibition"]},
1:{title:"1914 World War I",desc:"Indigenous soldiers have returned from war. They served alongside non Indigenous soldiers. What policy do you enforce?",choices:["Reinstate prohibition immediately","Grant veterans equal access to licensed establishments","Allow access only with special permits"]},
2:{title:"1939 World War II",desc:"Once again Indigenous soldiers return from war. The same question arises.",choices:["Maintain exclusion policies","Fully integrate Indigenous veterans into Canadian veteran systems","Keep prohibition but create veteran exceptions"]},
3:{title:"1951 Law Gets Stricter",desc:"The Special Committee reviewed the Indian Act. Public concern about alcohol remains. What do you do?",choices:["Make possession illegal everywhere, on and off reserve (What actually happened)","Decriminalize possession and focus on health based approaches","Keep current laws but add more treatment programs"]},
4:{title:"1960 Tommy Douglas Moment",desc:"A provincial leader argues Canada must stop treating Indigenous people as second class citizens. How do you respond?",choices:["Maintain federal control and prohibition","Begin removing discriminatory provisions","Allow provinces to decide individually"]},
5:{title:"1960s to 80s Generational Trauma",desc:"Evidence shows trauma from residential schools and prohibition policies. What approach do you take?",choices:["Ignore the findings and maintain status quo","Fund community led healing programs","Increase policing instead of support"]},
6:{title:"1985 Repeal",desc:"The discriminatory provisions are repealed. What happens next?",choices:["Leave communities to manage consequences alone","Support self governance and healing initiatives","Repeal the law but keep federal oversight"]}};
function showDecision(decIdx){
curDec=decIdx;
var d=decisions[decIdx];
var html=`<h2>${d.title}</h2><p>${d.desc}</p>`;
for(var i=0;i<d.choices.length;i++){
html+=`<button class="choice-btn" onclick="showConsequence(${i+1})">${d.choices[i]}</button>`;
}
document.getElementById('decision').innerHTML=html;
document.getElementById('decision').style.display='block';
document.exitPointerLock();
lock=0;
}

function showConsequence(choice){
document.getElementById('decision').style.display='none';
var cons=document.getElementById('consequence');
var html='';
var results=[
[`<h2>Result: Ban alcohol completely</h2><p>What happened:</p><p>Black market activity increased<br>People had to buy from sketchy dealers<br>Rapid drinking behavior developed (chugging in alleys to avoid getting caught)<br>Arrest rates went up fast<br>Stereotypes started forming that Indigenous people "can't handle alcohol"<br>The law forced people to hide their drinking which made it way more dangerous</p>`,
`<h2>Result: Equal laws for everyone</h2><p>What happened:</p><p>No underground black market needed<br>No one getting arrested just for their race<br>No forced rapid drinking to hide<br>People could drink normally like everyone else<br>Stereotypes never would have started<br>Treating people equally from the start would have prevented decades of harm</p>`,
`<h2>Result: Economic support and partnerships</h2><p>What happened:</p><p>Communities get funding for real problems (poverty, lack of jobs)<br>Trust between government and Indigenous people grows<br>Lower harm in the long run<br>No racist stereotypes get created<br>People can actually address root causes instead of just banning stuff</p>`],
[`<h2>Result: Prohibition reinstated</h2><p>What happened:</p><p>Veterans can't enter Legion halls<br>Can't access their benefits or support networks<br>Massive resentment builds up<br>Second class citizenship confirmed<br>Veterans who fought for Canada treated worse than other vets</p>`,
`<h2>Result: Equal veteran access</h2><p>What happened:</p><p>Veterans share support networks<br>Access to all veteran benefits<br>Integration into Canadian society<br>Recognition for service<br>Less long term trauma</p>`,
`<h2>Result: Special permits only</h2><p>What happened:</p><p>Still dependent on Indian Agents for permission<br>Unequal treatment continues<br>Veterans still treated differently than other vets<br>Permits can be denied for any reason<br>Doesn't solve the core issue of inequality</p>`],
[`<h2>Result: Maintain exclusion</h2><p>What happened:</p><p>Frustration builds across generations<br>Social isolation increases<br>Economic stability decreases<br>Over 3000 people served and still treated like second class citizens<br>Same mistakes as WWI repeated</p>`,
`<h2>Result: Full integration</h2><p>What happened:</p><p>Shared veteran networks finally<br>Equal access to benefits and support<br>Reduced long term harm to communities<br>Recognition that service matters more than race<br>Families stay together</p>`,
`<h2>Result: Veteran exceptions only</h2><p>What happened:</p><p>Creates two classes of Indigenous people<br>Non veterans still face full prohibition<br>Divides communities<br>Doesn't address the fundamental inequality<br>Still perpetuates stereotypes</p>`],
[`<h2>Result: Illegal everywhere (What Actually Happened)</h2><p>This is what Canada actually did in 1951.</p><p>What happened:</p><p>Increased surveillance of Indigenous people<br>Daily life became criminalized<br>60 to 80% of jail inmates in Western Canada were Indigenous<br>Fines and jail meant lost jobs and homes<br>Kids taken away when parents jailed<br>Communities lost trust in government<br>Trauma cycles started<br>Stereotypes got way worse<br>This lasted 34 MORE YEARS until 1985</p>`,
`<h2>Result: Decriminalize and focus on health</h2><p>What could have happened:</p><p>Way less people in jail<br>Families stay together<br>People keep their dignity<br>Stereotypes form slower or not at all<br>Health programs actually work when people aren't scared of arrest<br>Communities can develop their own solutions</p>`,
`<h2>Result: Keep laws but add treatment</h2><p>What would have happened:</p><p>People still get arrested so they don't trust treatment<br>Programs get underfunded after a few years<br>You can't help people you're also criminalizing<br>Black market continues<br>Doesn't solve the core problem of inequality</p>`],
[`<h2>Result: Keep federal prohibition</h2><p>What happened:</p><p>Systemic inequality continues<br>Public criticism grows louder<br>Canada looks bad internationally<br>Tommy Douglas's words about "apartheid" prove true<br>More years wasted</p>`,
`<h2>Result: Remove discriminatory laws</h2><p>What happened:</p><p>Policy reform starts moving forward<br>Public opinion begins shifting<br>Other provinces follow Saskatchewan's lead<br>Gradual normalization begins<br>Momentum builds for more equality<br>Saskatchewan actually did this in July 1960</p>`,
`<h2>Result: Let provinces decide individually</h2><p>What happened:</p><p>Creates patchwork of different rules<br>Some provinces drag their feet for years<br>Indigenous people have different rights depending where they live<br>Inequality continues in some places<br>Slow inconsistent progress</p>`],
[`<h2>Result: Ignore and maintain status quo</h2><p>What happened:</p><p>Trauma cycles keep going for another generation<br>Substance use becomes coping mechanism for residential school survivors<br>Public stereotypes get even stronger<br>No healing happens<br>Problems get passed down to kids<br>Community breakdown accelerates</p>`,
`<h2>Result: Fund community healing</h2><p>What happened:</p><p>Cultural restoration programs start<br>Elders can pass down traditional knowledge<br>Long term recovery becomes possible<br>Communities design their own solutions<br>Reduced dependency on harmful coping<br>Next generation has better tools</p>`,
`<h2>Result: More policing</h2><p>What happened:</p><p>Incarceration rates skyrocket<br>Communities become destabilized<br>Police presence creates more tension<br>Doesn't address root causes of trauma<br>Makes everything worse<br>Costs way more money than healing programs</p>`],
[`<h2>Result: Leave communities alone</h2><p>What happened:</p><p>Recovery is slow and hard<br>No resources to develop community alcohol policies<br>Public misunderstanding continues<br>Stereotypes persist for decades<br>Communities struggle without support</p>`,
`<h2>Result: Support self governance and healing</h2><p>What happened:</p><p>Communities gain control over their own policies<br>Band councils create rules that fit local needs<br>Healing programs get proper funding<br>Stereotype dismantling begins<br>Long term recovery becomes real</p>`,
`<h2>Result: Repeal but keep federal oversight</h2><p>What happened:</p><p>Still not full self governance<br>Communities can't fully control their own affairs<br>Federal government still interfering<br>Partial freedom isn't real freedom<br>Slows down recovery</p>`]
];
html=results[curDec][choice-1]+'<button class="close-btn" onclick="closeConsequence()">Continue Exploring</button>';
cons.innerHTML=html;
cons.style.display='block';
}

function closeConsequence(){
document.getElementById('consequence').style.display='none';
document.body.requestPointerLock();
}

function start(){
started=1;
scene=new THREE.Scene();
cam=new THREE.PerspectiveCamera(75,innerWidth/innerHeight,0.1,1000);
cam.position.set(-4,1.6,10);
yaw=-Math.PI/2;
rend=new THREE.WebGLRenderer({antialias:1});
rend.setSize(innerWidth,innerHeight);
document.getElementById('canvas').appendChild(rend.domElement);
raycaster=new THREE.Raycaster();
mouse=new THREE.Vector2();

var floor=new THREE.Mesh(new THREE.PlaneGeometry(100,100),new THREE.MeshStandardMaterial({color:0x1a1a1a}));
floor.rotation.x=-Math.PI/2;scene.add(floor);
var wmat=new THREE.MeshStandardMaterial({color:0x2a2a2a});
[[[-12,4,-10,Math.PI/2],[4,4,-10,-Math.PI/2],[-4,4,-60,0],[-4,4,15,Math.PI]]].forEach(w=>{var wall=new THREE.Mesh(new THREE.PlaneGeometry(100,8),wmat);wall.position.set(w[0],w[1],w[2]);wall.rotation.y=w[3];scene.add(wall)});
var roof=new THREE.Mesh(new THREE.PlaneGeometry(16,100),wmat);
roof.rotation.x=Math.PI/2;roof.position.set(-4,8,-10);scene.add(roof);
scene.add(new THREE.AmbientLight(0xffffff,3));
[[0,10,10],[0,10,-30]].forEach(l=>{var lt=new THREE.DirectionalLight(0xffffff,2);lt.position.set(l[0],l[1],l[2]);scene.add(lt)});

for(var i=0;i<8;i++){
var z=10-i*8;
mkPanel(DATA[i],-11.95,3,z);
}

var photoFiles=[
'348501590_604258475143586_4088697206806077063_n.jpg',
'tomlongboat.jpg',
'indigneous2ww2.avif',
'1951.jpg',
'Premier_Tommy_Douglas_(F1257_s1057_it2743).jpg',
'residentialschool.jpg',
'poltach ban.jpg'
];
var photoCaptions=[
'Indigenous people in 1880s Canada before criminalization',
'Tom Longboat, WWI Indigenous veteran who served but faced discrimination at home',
'Indigenous WWII soldiers fought alongside Canadians but faced discrimination at home',
'The 1951 amendment made possession illegal everywhere, on and off reserve',
'Premier Tommy Douglas spoke out against treating Indigenous people as second-class citizens',
'Residential school children were forcibly separated from families, creating generational trauma',
'Potlatch ban: Indigenous ceremonies were criminalized from 1885-1951'
];
for(i=0;i<7;i++){
var fr=new THREE.Mesh(new THREE.PlaneGeometry(2,1.5),new THREE.MeshStandardMaterial({color:0x4a3a2a}));
fr.position.set(3.95,3,8-i*8);fr.rotation.y=-Math.PI/2;scene.add(fr);
var loader=new THREE.TextureLoader();
loader.setCrossOrigin('anonymous');
(function(idx){
loader.load(photoFiles[idx],function(tex){
var pic=new THREE.Mesh(new THREE.PlaneGeometry(1.8,1.3),new THREE.MeshStandardMaterial({map:tex}));
pic.position.set(3.92,3,8-idx*8);pic.rotation.y=-Math.PI/2;scene.add(pic);
});
var capPanel=new THREE.Mesh(new THREE.PlaneGeometry(2,0.4),new THREE.MeshStandardMaterial({color:0x1a1414}));
capPanel.position.set(3.95,1.8,8-idx*8);capPanel.rotation.y=-Math.PI/2;scene.add(capPanel);
var capCv=document.createElement('canvas'),capCtx;
capCv.width=512;capCv.height=128;capCtx=capCv.getContext('2d');
capCtx.fillStyle='#1a1414';capCtx.fillRect(0,0,512,128);capCtx.fillStyle='#c4a86b';capCtx.font='18px "Source Sans 3"';capCtx.textAlign='center';
var words=photoCaptions[idx].split(' '),line='',yy=35;
words.forEach(w=>{var test=line+w+' ';if(capCtx.measureText(test).width>480&&line){capCtx.fillText(line,256,yy);line=w+' ';yy+=22}else line=test});
capCtx.fillText(line,256,yy);
var capTex=new THREE.Mesh(new THREE.PlaneGeometry(1.98,0.38),new THREE.MeshStandardMaterial({map:new THREE.CanvasTexture(capCv)}));
capTex.position.set(3.92,1.8,8-idx*8);capTex.rotation.y=-Math.PI/2;scene.add(capTex);
})(i);
}

[[0,0x8B0000],[1,0xd4a843],[2,0xcc2222],[3,0x5a3a2a],[4,0x7a7a3a],[5,0x8a6a4a],[6,0x8b4513]].forEach((a,i)=>mkArt(-8,0.8,10-i*8,a[0],a[1]));

run();
}

function mkPanel(d,x,y,z){
var p=new THREE.Mesh(new THREE.PlaneGeometry(6,4),new THREE.MeshStandardMaterial({color:0x1a1414}));
p.position.set(x,y,z);p.rotation.y=Math.PI/2;scene.add(p);

var cv=document.createElement('canvas');
cv.width=1536;cv.height=1024;
var ctx=cv.getContext('2d');
ctx.fillStyle='#1a1414';ctx.fillRect(0,0,1536,1024);

if(d.qr){
var img=new Image();
img.onload=function(){
ctx.drawImage(img,468,250,600,600);
ctx.fillStyle='#c4a86b';ctx.font='bold 90px "Source Sans 3"';ctx.textAlign='center';
ctx.fillText(d.y,768,150);
ctx.fillStyle='#e8e0d4';ctx.font='48px "Source Sans 3"';
ctx.fillText(d.txt,768,900);
p.material.map=new THREE.CanvasTexture(cv);
};
img.src='Screenshot 2026-02-21 015409.png';
}else{
ctx.fillStyle='#c4a86b';ctx.font='bold 110px "Source Sans 3"';ctx.textAlign='center';
ctx.fillText(d.y,768,140);
ctx.fillStyle='#a89878';ctx.font='italic 56px "Source Sans 3"';
ctx.fillText(d.t,768,240);
ctx.fillStyle='#e8e0d4';ctx.font='38px "Source Sans 3"';
wrap(ctx,d.txt,768,340,1336,56);
p.material.map=new THREE.CanvasTexture(cv);
}
}

function wrap(ctx,txt,x,y,mw,lh){
var w=txt.split(' '),ln='';
for(var n=0;n<w.length;n++){
var test=ln+w[n]+' ';
if(ctx.measureText(test).width>mw&&n>0){
ctx.fillText(ln,x,y);ln=w[n]+' ';y+=lh;
}else{ln=test}
}
ctx.fillText(ln,x,y);
}

function mkArt(x,y,z,typ,col){
var ped=new THREE.Mesh(new THREE.CylinderGeometry(0.4,0.5,0.8,8),new THREE.MeshStandardMaterial({color:0x4a4a4a,metalness:0.5}));
ped.position.set(x,0.4,z);scene.add(ped);
var g=new THREE.Group();
if(typ==0){
var b=new THREE.Mesh(new THREE.CylinderGeometry(0.12,0.15,0.5,12),new THREE.MeshStandardMaterial({color:0x2a4a2a,transparent:1,opacity:0.7}));
b.position.y=0.25;g.add(b);
var n=new THREE.Mesh(new THREE.CylinderGeometry(0.06,0.08,0.2,12),new THREE.MeshStandardMaterial({color:0x2a4a2a,transparent:1,opacity:0.7}));
n.position.y=0.6;g.add(n);
}else if(typ==1){
var m=new THREE.Mesh(new THREE.CylinderGeometry(0.2,0.2,0.04,16),new THREE.MeshStandardMaterial({color:col,metalness:0.9}));
m.rotation.x=Math.PI/2;m.position.y=0.15;g.add(m);
}else if(typ==2){
for(var i=0;i<5;i++){
var pt=new THREE.Mesh(new THREE.SphereGeometry(0.15,12,12),new THREE.MeshStandardMaterial({color:0xcc2222}));
pt.scale.set(1,0.3,1);pt.position.set(Math.cos(i*Math.PI*2/5)*0.12,0,Math.sin(i*Math.PI*2/5)*0.12);g.add(pt);
}
var c=new THREE.Mesh(new THREE.SphereGeometry(0.08,12,12),new THREE.MeshStandardMaterial({color:0x1a1a1a}));
g.add(c);
}else if(typ==3){
var h=new THREE.Mesh(new THREE.CylinderGeometry(0.12,0.12,0.35,12),new THREE.MeshStandardMaterial({color:col}));
h.rotation.z=Math.PI/2;h.position.set(0.15,0.15,0);g.add(h);
var hnd=new THREE.Mesh(new THREE.CylinderGeometry(0.04,0.04,0.45,8),new THREE.MeshStandardMaterial({color:0x4a2a1a}));
hnd.rotation.z=-Math.PI/4;hnd.position.set(-0.15,-0.05,0);g.add(hnd);
}else if(typ==4){
var p=new THREE.Mesh(new THREE.CylinderGeometry(0.025,0.025,0.7,12),new THREE.MeshStandardMaterial({color:col,metalness:0.8}));
p.position.y=0.15;g.add(p);
var br=new THREE.Mesh(new THREE.BoxGeometry(0.7,0.025,0.025),new THREE.MeshStandardMaterial({color:col,metalness:0.8}));
br.position.y=0.5;g.add(br);
}else if(typ==5){
var bd=new THREE.Mesh(new THREE.SphereGeometry(0.15,12,12),new THREE.MeshStandardMaterial({color:col}));
bd.scale.set(1,1.2,0.8);g.add(bd);
var hd=new THREE.Mesh(new THREE.SphereGeometry(0.12,12,12),new THREE.MeshStandardMaterial({color:col}));
hd.position.y=0.22;g.add(hd);
}else if(typ==6){
var cv=new THREE.Mesh(new THREE.BoxGeometry(0.35,0.45,0.05),new THREE.MeshStandardMaterial({color:col}));
g.add(cv);
var pg=new THREE.Mesh(new THREE.BoxGeometry(0.33,0.43,0.04),new THREE.MeshStandardMaterial({color:0xf5f5dc}));
pg.position.z=0.02;g.add(pg);
}
g.position.set(x,1.1,z);g.userData.decIdx=typ;scene.add(g);
artifacts.push(g);
}

function run(){
requestAnimationFrame(run);
var s=0.1,sy=Math.sin(yaw),cy=Math.cos(yaw);
if(keys.w){cam.position.x-=sy*s;cam.position.z-=cy*s}
if(keys.s){cam.position.x+=sy*s;cam.position.z+=cy*s}
if(keys.a){cam.position.x-=cy*s;cam.position.z+=sy*s}
if(keys.d){cam.position.x+=cy*s;cam.position.z-=sy*s}
cam.position.x=Math.max(-11,Math.min(3,cam.position.x));cam.position.z=Math.max(-58,Math.min(14,cam.position.z));
cam.rotation.order='YXZ';cam.rotation.y=yaw;cam.rotation.x=pitch;rend.render(scene,cam);
}

var keyMap={'w':1,'ArrowUp':1,'s':1,'ArrowDown':1,'a':1,'ArrowLeft':1,'d':1,'ArrowRight':1};
document.addEventListener('keydown',e=>{var k=e.key;if(keyMap[k])keys[k=='ArrowUp'?'w':k=='ArrowDown'?'s':k=='ArrowLeft'?'a':k=='ArrowRight'?'d':k]=1});
document.addEventListener('keyup',e=>{var k=e.key;if(keyMap[k])keys[k=='ArrowUp'?'w':k=='ArrowDown'?'s':k=='ArrowLeft'?'a':k=='ArrowRight'?'d':k]=0});
document.addEventListener('click',function(e){
if(!started)return;
if(scene){
mouse.x=(e.clientX/innerWidth)*2-1;mouse.y=-(e.clientY/innerHeight)*2+1;
raycaster.setFromCamera(mouse,cam);
var intersects=raycaster.intersectObjects(artifacts,true),obj;
if(intersects.length>0){
obj=intersects[0].object;
while(obj.parent&&obj.userData.decIdx===undefined)obj=obj.parent;
if(obj.userData.decIdx!==undefined&&!shown[obj.userData.decIdx]){shown[obj.userData.decIdx]=1;showDecision(obj.userData.decIdx);return}
}
}
document.body.requestPointerLock();
});
document.addEventListener('pointerlockchange',()=>lock=document.pointerLockElement===document.body);
document.addEventListener('mousemove',e=>{
if(!lock)return;
yaw-=(e.movementX||0)*0.002;
pitch-=(e.movementY||0)*0.002;
pitch=Math.max(-Math.PI/2,Math.min(Math.PI/2,pitch));
});
window.addEventListener('resize',()=>{
cam.aspect=innerWidth/innerHeight;
cam.updateProjectionMatrix();
rend.setSize(innerWidth,innerHeight);
});
</script>
</body>
</html>
